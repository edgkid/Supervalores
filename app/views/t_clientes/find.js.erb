$("#client-container").html("<%= escape_javascript(render('t_facturas/cliente')) %>");
var attribute = '<%= @attribute %>',
    codigo = '<%= @t_cliente ? @t_cliente.codigo : "" %>',
    cedula = '<%= @t_persona ? @t_persona.cedula : "" %>',
    rif = '<%= @t_empresa ? @t_empresa.rif : "" %>',
    zeroLength = false;
    // razon_social = '<%#= @t_cliente.razon_social %>';

var data = [
  <% @t_cliente.t_resolucions.each do |t_resolucion| %>
    {
      id: <%= t_resolucion.id %>,
      text: '<%= t_resolucion.resolucion_codigo %>'
    },
  <% end if @t_cliente %>
]

if (data.length === 0) {
  zeroLength = true;
}

switch(attribute) {
  case 'select-codigo':
    if (zeroLength) {
      $('#select2-select-resolucion-container').text('');
      $('#select2-select-resolucion-container').attr('title', '');
    } else {
      $('#select-resolucion').empty().append('<option></option>').select2({ data: data, placeholder: 'Seleccione' });

      <% @t_tarifa = @t_cliente.t_resolucions.first.t_tipo_cliente.t_tarifa %>

      amount = Number(<%= @t_tarifa.monto if @t_tarifa %>),
      surcharge = Number(<%= @t_tarifa.recargo if @t_tarifa %>),
      totalRate = amount + (amount * surcharge);

      $('#rate-amount').text(amount);
      $('#rate-surcharge').text(surcharge);
      $('#total-rate').text(totalRate);

      $('#total').text(Number($('#total').text()) + totalRate);
    }

    <% if @t_cliente && @t_persona %>
      $('#select2-select-cedula-container').text(cedula);
      $('#select2-select-cedula-container').attr('title', cedula);
    <% elsif @t_empresa %>
      $('#select2-select-cedula-container').text(rif);
      $('#select2-select-cedula-container').attr('title', rif);
    <% else %>
      $('#select2-select-cedula-container').text('');
      $('#select2-select-cedula-container').attr('title', '');
    <% end %>

    $('#select-codigo-input').val($('#select-codigo').val());
    $('#select-cedula-input').val($('#select2-select-cedula-container').text());
    break;
  case 'select-cedula':
    if (zeroLength) {
      $('#select2-select-resolucion-container').text('');
      $('#select2-select-resolucion-container').attr('title', '');
    } else {
      $('#select-resolucion').empty().append('<option></option>').select2({ data: data, placeholder: 'Seleccione' });

      amount = Number(<%= @t_tarifa.monto if @t_tarifa %>),
      surcharge = Number(<%= @t_tarifa.recargo if @t_tarifa %>),
      totalRate = amount + (amount * surcharge);

      $('#rate-amount').text(amount);
      $('#rate-surcharge').text(surcharge);
      $('#total-rate').text(totalRate);

      $('#total').text(Number($('#total').text()) + totalRate);
    }

    $('#select2-select-codigo-container').text(codigo);
    $('#select2-select-codigo-container').attr('title', codigo);

    $('#select-codigo-input').val($('#select2-select-codigo-container').text());
    $('#select-cedula-input').val($('#select-cedula').val());
    break;
  case 'select-resolucion':
    $('#select2-select-codigo-container').text(codigo);
    $('#select2-select-codigo-container').attr('title', codigo);

    <% if @t_cliente && @t_persona %>
      $('#select2-select-cedula-container').text(cedula);
      $('#select2-select-cedula-container').attr('title', cedula);
    <% elsif @t_empresa %>
      $('#select2-select-cedula-container').text(rif);
      $('#select2-select-cedula-container').attr('title', rif);
    <% end %>

    amount = Number(<%= @t_tarifa.monto if @t_tarifa %>),
    surcharge = Number(<%= @t_tarifa.recargo if @t_tarifa %>),
    totalRate = amount + (amount * surcharge);

    $('#rate-amount').text(amount);
    $('#rate-surcharge').text(surcharge);
    $('#total-rate').text(totalRate);

    $('#total').text(Number($('#total').text()) + totalRate);
    break;
}

<% if @t_resolucion %>
  $('#input-resolucion').val(<%= @t_resolucion.id %>);
<% else %>
  $('#input-resolucion').val($('#select-resolucion').val());
<% end %>

$('#select-resolucion-input').val($('#select-resolucion').text());

// alert($('#input-resolucion').val());
// alert(<%#= @t_resolucion.t_tipo_cliente.t_tarifa.monto %>);
// setTtotal('#total', getTotal('.subtotal-cell'));
